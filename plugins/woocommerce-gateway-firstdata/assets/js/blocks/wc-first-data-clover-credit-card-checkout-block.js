(()=>{"use strict";const e=window.React,t=window.wc.wcBlocksRegistry,a=window.wp.htmlEntities,n=window.wp.i18n,r=t=>{const{settings:r={},edit:o=!1}=t,s=(0,a.decodeEntities)(r.description||""),c=`sv-wc-payment-method-description wc-${r.id}-description`;return r?.flags?.is_test_environment&&!o?(0,e.createElement)("div",{style:{display:"grid",marginBlockEnd:"1rem"}},(0,e.createElement)("p",{className:c},s),(0,e.createElement)("strong",null,(0,n.__)("Test Mode Enabled","wc-plugin-framework").toUpperCase()),(0,e.createElement)("p",{style:{margin:0},dangerouslySetInnerHTML:{__html:(0,n.sprintf)((0,n._x)("Use the following %scard numbers%s with card security code %s123%s.","Credit card test numbers","woocommerce-gateway-firstdata"),'<a href="https://docs.clover.com/docs/test-card-numbers" target="_blank">',"</a>",'<span style="font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;">',"</span>")}}),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"max-content min-content",gap:"8px",alignItems:"center",paddingTop:"8px"}},(0,e.createElement)("div",{style:{backgroundColor:"rgb(21 128 61)",display:"flex",justifyContent:"center",borderRadius:"16px",color:"white",userSelect:"none",fontWeight:"semibold",fontSize:"0.75rem",padding:"0.125rem 0.625rem",transition:"background-color 0.2s",outline:"none",ring:"2",ringRing:"ring",ringOffset:"2"}},(0,n.__)("Approved","woocommerce-gateway-firstdata")),(0,e.createElement)("span",{style:{fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'}},r.test_card_number_approval),(0,e.createElement)("div",{style:{backgroundColor:"rgb(185 28 28)",display:"flex",justifyContent:"center",borderRadius:"16px",color:"white",userSelect:"none",fontWeight:"semibold",fontSize:"0.75rem",padding:"0.125rem 0.625rem",transition:"background-color 0.2s",outline:"none",ring:"2",ringRing:"ring",ringOffset:"2"}}," ",(0,n.__)("Declined","woocommerce-gateway-firstdata")),(0,e.createElement)("span",{style:{fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace'}},r.test_card_number_decline))):(0,e.createElement)("p",{className:c},s)},o=window.wp.element,s=(0,window.wc.wcSettings.getPaymentMethodData)("first_data_clover_credit_card",{}),c=(e,t=null)=>{s.debug_mode&&"off"!=s.debug&&(console.log(`Clover: ${e}`),t&&console.log(t))},i=window.wc.blocksCheckout,l=t=>(0,e.createElement)(i.Label,{label:t.label,screenReaderLabel:t.screenReaderLabel||t.label,wrapperElement:"label",wrapperProps:{htmlFor:t.htmlFor,className:"required"},htmlFor:t.htmlFor}),d=t=>{const{className:a="",id:n,gatewayId:r,error:o,label:s,name:c,...d}=t,m=n||`wc-${r}-${c}-hosted`;return(0,e.createElement)("div",{className:[`wc-block-gateway-container wc-card-${c}-element`,a].join(" "),...d},(0,e.createElement)(l,{label:s,htmlFor:m}),(0,e.createElement)("div",{id:m,style:{paddingTop:"14px"},className:[`wc-block-gateway-input empty wc-${r}-hosted-field-input`].join(" ")}),(0,e.createElement)(i.ValidationInputError,{errorMessage:o}))},m=t=>{const{components:{LoadingMask:a},isLoaded:r,hostedFieldsInstance:c}=t,i={CARD_NUMBER:"number",CARD_DATE:"expiry",CARD_CVV:"cvc",CARD_STREET_ADDRESS:"streetAddress",CARD_POSTAL_CODE:"postalCode"},[l,m]=(0,o.useState)({number:"",expiry:"",cvc:"",streetAddress:"",postalCode:""});function p(e){for(const[t,a]of Object.entries(i))void 0!==e[t]&&void 0!==e[t].error&&m((n=>({...n,[a]:e[t].error}))),void 0!==e[t]&&void 0===e[t].error&&e[t].touched&&m((e=>({...e,[a]:""})))}return(0,o.useEffect)((()=>{c&&Object.values(c).forEach((e=>{e.addEventListener("change",(e=>{p(e)})),e.addEventListener("blur",(e=>{p(e)}))}))}),[c]),(0,e.createElement)(a,{isLoading:!r,showSpinner:!0},(0,e.createElement)("div",{style:{display:"grid"},className:`wc-block-card-elements payment_method_${s.name}`},(0,e.createElement)(d,{name:"number",gatewayId:s.id,error:l.number,label:(0,n.__)("Card Number","woocommerce-gateway-firstdata")}),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"}},(0,e.createElement)(d,{name:"expiry",gatewayId:s.id,error:l.expiry,label:(0,n.__)("Expiration","woocommerce-gateway-firstdata")}),(0,e.createElement)(d,{name:"cvc",gatewayId:s.id,error:l.cvc,label:(0,n.__)("CVV","woocommerce-gateway-firstdata")})),s.flags?.avs_street_address&&(0,e.createElement)(d,{name:"street-address",gatewayId:s.id,error:l.streetAddress,label:(0,n.__)("Street Address","woocommerce-gateway-firstdata")}),(0,e.createElement)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"16px"}},(0,e.createElement)(d,{name:"postal-code",gatewayId:s.id,error:l.postalCode,label:(0,n.__)("Postal Code","woocommerce-gateway-firstdata")}))))},p=t=>{const{settings:a={}}=t,n=a.icons||{},r=Object.values(n).map((t=>(0,e.createElement)("img",{src:t.src,alt:t.alt,style:{maxWidth:"40px"},key:t.id})));return(0,e.createElement)("div",{className:`sv-wc-payment-method-icons wc-${a.id}-icons`,style:{verticalAlign:"middle",display:"flex",flexWrap:"wrap",marginLeft:"auto",gap:"5px"}},r)},g={name:s.name,label:(0,e.createElement)((t=>{const{settings:n={}}=t,r=(0,a.decodeEntities)(n.title||"");return(0,e.createElement)("div",{className:`sv-wc-payment-method-label wc-${n.id}-label`,style:{display:"flex",verticalAlign:"middle",gap:"5px",justifyContent:"space-between",width:"100%",paddingRight:"16px"}},r,(0,e.createElement)(p,{settings:n}))}),{settings:s}),content:(0,e.createElement)((t=>{const{eventRegistration:i,emitResponse:l}=t,{onPaymentSetup:d,onCheckoutFail:p}=i,g=(()=>{const[e,t]=(0,o.useState)(null),[a,n]=(0,o.useState)(null);return{setupIntegration:(0,o.useCallback)((async()=>{const e=`wc-${s.id}-number-hosted`,a=`wc-${s.id}-expiry-hosted`,r=`wc-${s.id}-cvc-hosted`,o=`wc-${s.id}-street-address-hosted`,c=`wc-${s.id}-postal-code-hosted`;if(0===document.getElementById(e).length)return;if(0!==document.getElementById(e).getElementsByTagName("iframe").length)return;const i=new Clover(s.public_token,{locale:s.locale}),l=i.elements(),d={body:{fontFamily:'"Source Sans Pro","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,"Lucida Grande",sans-serif'},input:{fontSize:"16px",fontWeight:"400"},...s.hosted_field_styles},m={cardNumber:l.create("CARD_NUMBER",d),expiry:l.create("CARD_DATE",d),cvv:l.create("CARD_CVV",d),postalCode:l.create("CARD_POSTAL_CODE",d)};m.cardNumber.mount(`#${e}`),m.expiry.mount(`#${a}`),m.cvv.mount(`#${r}`),m.postalCode.mount(`#${c}`),s.flags?.avs_street_address&&(m.streetAddress=l.create("CARD_STREET_ADDRESS",d),m.streetAddress.mount(`#${o}`)),t(m),n(i)}),[]),hostedFieldsInstance:e,integrationInstance:a}})(),{setupIntegration:u,hostedFieldsInstance:y,integrationInstance:w}=g,[f,E]=(0,o.useState)(""),[_,b]=(0,o.useState)(!1);return(0,o.useEffect)((()=>(async function(){try{await u(),b(!0),c("Clover loading complete")}catch(e){c(`Integration Error: ${e.message}`,e),E((0,n.__)("An error occurred while loading the payment form.","woocommerce-gateway-firstdata"))}}(),()=>{b(!1)})),[u]),(0,o.useEffect)((()=>{const e=p?.((async e=>{const{paymentStatus:t,paymentDetails:a}=e?.processingResponse||{};if(t===l?.responseTypes.FAIL&&a?.result===l?.responseTypes.FAIL&&a?.message)return{type:l?.responseTypes.FAIL,message:(0,n.__)("An error occurred, please try again or try an alternate form of payment.","woocommerce-gateway-firstdata"),messageContext:"full"===s?.debug_mode||"checkout"===s?.debug_mode?l?.noticeContexts?.CHECKOUT:l?.noticeContexts?.PAYMENTS,retry:!0}}));return()=>e?.()}),[l?.noticeContexts?.CHECKOUT,l?.noticeContexts?.PAYMENTS,l?.responseTypes.FAIL,p]),((e,t,n)=>{function r(e){const n={type:t.responseTypes.ERROR,messageContext:t.noticeContexts.PAYMENTS};let r="";return e.errors?Object.values(e.errors).forEach((e=>{r+=e+"\n"})):r=JSON.stringify(e),{...n,message:(0,a.decodeEntities)(r)}}(0,o.useEffect)((()=>e((async()=>{try{const e=await n.createToken();if(void 0===e.token)return r(e);const a={[`wc-${s.id}-js-token`]:e.token,[`wc-${s.id}-account-number`]:`${e.card.first6}${e.card.last4}`,[`wc-${s.id}-exp-month`]:e.card.exp_month,[`wc-${s.id}-exp-year`]:e.card.exp_year};return{type:t.responseTypes.SUCCESS,meta:{paymentMethodData:a}}}catch(e){return r(e)}}))),[t.responseTypes.SUCCESS,t.responseTypes.ERROR,t.noticeContexts.PAYMENTS,e,n])})(d,l,w),f?(0,e.createElement)("div",{className:"woocommerce-error"},f):(0,e.createElement)(e.Fragment,null,(0,e.createElement)(r,{settings:s}),(0,e.createElement)(m,{...t,isLoaded:_,hostedFieldsInstance:y}))}),null),edit:(0,e.createElement)(r,{settings:s,edit:!0}),canMakePayment:()=>!0,icons:s.icons,ariaLabel:(0,a.decodeEntities)(s.title),supports:{features:s.supports,showSavedCards:s.flags?.tokenization_enabled||!1,showSaveOption:!s?.flags?.tokenization_forced&&s?.flags?.tokenization_enabled}};(0,t.registerPaymentMethod)(g)})();